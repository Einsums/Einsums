#----------------------------------------------------------------------------------------------
# Copyright (c) The Einsums Developers. All rights reserved.
# Licensed under the MIT License. See LICENSE.txt in the project root for license information.
#----------------------------------------------------------------------------------------------

# Do not edit this file! It has been generated by the libs/create_module_skeleton.py script.

include(Einsums_Message)

include(Einsums_ExtendWithPython)

if(NOT EINSUMS_PYTHON_VERSION)
  find_package(
    Python3
    COMPONENTS Interpreter Development
    REQUIRED
  )
else()
  find_package(
    Python3 "${EINSUMS_PYTHON_VERSION}" EXACT
    COMPONENTS Interpreter Development
    REQUIRED
  )
endif()

find_package(pybind11 REQUIRED)

einsums_extend_with_python(${EINSUMS_PYTHON_LIB_NAME} ${PYTHON_LIB_TYPE})

set_target_properties(${EINSUMS_PYTHON_LIB_NAME} PROPERTIES OUTPUT_NAME core)

# cmake-format: off
set(_EinsumsPy_modules
  Core
  Errors
  GPU
  Tensor
  TensorAlgebra
  TestUtils
)
# cmake-format: on

einsums_info("")
einsums_info("  Configuring EinsumsPy modules:")

foreach(module ${_EinsumsPy_modules})
  add_subdirectory(${module})
endforeach()

set(EinsumsPy_EXPORT_FUNCTIONS)
set(EinsumsPy_EXPORTS)

foreach(module ${_EinsumsPy_modules})
  if(TARGET ${EINSUMS_PYTHON_LIB_NAME}_${module})
    set(EinsumsPy_EXPORT_FUNCTIONS
        "${EinsumsPy_EXPORT_FUNCTIONS}void export_${module}(py::module_ &mod);\n"
    )
    set(EinsumsPy_EXPORTS "${EinsumsPy_EXPORTS}    export_${module}(mod);\n")
  endif()
endforeach()

configure_file(ExportAll.cpp.in ExportAll.cpp @ONLY)
target_sources(${EINSUMS_PYTHON_LIB_NAME} PRIVATE ${CMAKE_CURRENT_BINARY_DIR}/ExportAll.cpp)
